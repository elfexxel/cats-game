<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For My Love: Chruno33</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Dancing Script', cursive; }
        #joystick-container { position: fixed; bottom: 50px; left: 50px; width: 100px; height: 100px; background: rgba(255,255,255,0.2); border-radius: 50%; touch-action: none; }
        #counter { position: fixed; top: 20px; left: 20px; color: white; font-size: 24px; text-shadow: 2px 2px black; }
        #final-message { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            color: #8a2be2; font-size: 30px; text-align: center; display: none;
            background: rgba(0,0,0,0.7); padding: 20px; border-radius: 15px;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
</head>
<body>

<div id="counter">GÃ¼ller: 0 / 33</div>
<div id="joystick-container"></div>
<div id="final-message"></div>

<script type="module">
import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';

// --- SAHNE VE AYARLAR ---
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050510); // Gece havasÄ±
scene.fog = new THREE.FogExp2(0x050510, 0.05);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// IÅŸÄ±klandÄ±rma
const ambientLight = new THREE.AmbientLight(0x404040, 2);
scene.add(ambientLight);
const moonLight = new THREE.DirectionalLight(0xffffff, 0.5);
moonLight.position.set(10, 20, 10);
scene.add(moonLight);

// --- KAR YAÄžIÅžI ---
const snowGeometry = new THREE.BufferGeometry();
const snowCount = 2000;
const snowPositions = new Float32Array(snowCount * 3);
for(let i=0; i<snowCount*3; i++) { snowPositions[i] = (Math.random() - 0.5) * 100; }
snowGeometry.setAttribute('position', new THREE.BufferAttribute(snowPositions, 3));
const snowMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.1 });
const snow = new THREE.Points(snowGeometry, snowMaterial);
scene.add(snow);

// --- KARLI PATÄ°KA VE YOL ---
const floorGeo = new THREE.PlaneGeometry(20, 200);
const floorMat = new THREE.MeshStandardMaterial({ color: 0xffffff });
const floor = new THREE.Mesh(floorGeo, floorMat);
floor.rotation.x = -Math.PI / 2;
scene.add(floor);

// --- KEDÄ° MODELLEMELERÄ° (Basit 3D Temsili) ---
function createCat(bodyColor, eyeColor, name) {
    const group = new THREE.Group();
    // GÃ¶vde
    const body = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.4, 0.8), new THREE.MeshStandardMaterial({color: bodyColor}));
    body.position.y = 0.2;
    group.add(body);
    // Kafa
    const head = new THREE.Mesh(new THREE.BoxGeometry(0.4, 0.35, 0.35), new THREE.MeshStandardMaterial({color: bodyColor}));
    head.position.set(0, 0.45, 0.4);
    group.add(head);
    // GÃ¶zler
    const eyeGeo = new THREE.SphereGeometry(0.05);
    const eyeMat = new THREE.MeshBasicMaterial({color: eyeColor});
    const eyeL = new THREE.Mesh(eyeGeo, eyeMat); eyeL.position.set(0.1, 0.5, 0.55);
    const eyeR = new THREE.Mesh(eyeGeo, eyeMat); eyeR.position.set(-0.1, 0.5, 0.55);
    group.add(eyeL, eyeR);
    
    return group;
}

const chruno33 = createCat(0xffa500, 0x8b4513, "Chruno33"); // Turuncu, Kahverengi gÃ¶z
scene.add(chruno33);

const elfexxel = createCat(0x111111, 0x00ff00, "Elfexxel"); // Siyah, YeÅŸil gÃ¶z
elfexxel.position.set(0, 0, -95); // Yolun sonunda
scene.add(elfexxel);

// --- GÃœLLER ---
const roses = [];
const roseColors = [0x800080, 0xff0000, 0x000000]; // Mor, KÄ±rmÄ±zÄ±, Siyah
for(let i=0; i<33; i++) {
    const rose = new THREE.Mesh(
        new THREE.SphereGeometry(0.15), 
        new THREE.MeshStandardMaterial({color: roseColors[i % 3]})
    );
    rose.position.set((Math.random()-0.5)*4, 0.1, -i * 2.5 - 5);
    scene.add(rose);
    roses.push(rose);
}

// --- KONTROLLER ---
let moveForward = false, moveBackward = false, moveLeft = false, moveRight = false;
let collectedRoses = 0;
let gameState = "walking"; // walking, ending

// Mobil Kontrol (Basit Dokunmatik MantÄ±ÄŸÄ±)
window.addEventListener('touchstart', (e) => { moveForward = true; });
window.addEventListener('touchend', (e) => { moveForward = false; });

// --- OYUN DÃ–NGÃœSÃœ ---
function animate() {
    requestAnimationFrame(animate);

    if(gameState === "walking") {
        // Kar yaÄŸÄ±ÅŸÄ± hareketi
        snow.position.y -= 0.05;
        if(snow.position.y < -10) snow.position.y = 10;

        // Kedi Hareketi (Sadece ileri otomatik gidiÅŸ veya joystick eklenebilir)
        if(moveForward) chruno33.position.z -= 0.15;
        
        // Kamera Takibi
        camera.position.set(chruno33.position.x, chruno33.position.y + 2, chruno33.position.z + 5);
        camera.lookAt(chruno33.position);

        // GÃ¼l Toplama KontrolÃ¼
        roses.forEach((rose, index) => {
            if(rose.visible && chruno33.position.distanceTo(rose.position) < 0.6) {
                rose.visible = false;
                collectedRoses++;
                document.getElementById('counter').innerText = `GÃ¼ller: ${collectedRoses} / 33`;
            }
        });

        // Final Sahnesi GeÃ§iÅŸi
        if(collectedRoses >= 33 && chruno33.position.z < -90) {
            gameState = "ending";
            startFinalScene();
        }
    }
    
    renderer.render(scene, camera);
}

function startFinalScene() {
    // Burada denizi oluÅŸturup kamerayÄ± zoom yapacaÄŸÄ±z
    // Kedilerin birbirine yaklaÅŸmasÄ± ve Ã¶pÃ¼ÅŸme animasyonu tetiklenecek
    const msg = document.getElementById('final-message');
    msg.style.display = "block";
    msg.innerHTML = "elfexxel'den sevgilim chruno33'e <br> <span style='font-size:50px'>ðŸ˜›</span><br>i luv u";
    
    // Zoom ve Ã¶pÃ¼ÅŸme animasyonu iÃ§in kamera pozisyonu deÄŸiÅŸtirme
    camera.position.set(0, 0.5, -93);
    camera.lookAt(0, 0.5, -95);
}

animate();

// Ekran boyutunu ayarla
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

</script>
</body>
</html>
